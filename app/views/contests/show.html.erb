<h1>
    <%= @contest.name %>
</h1>

<div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true">
  <div class="panel panel-default">
    <div class="panel-heading" role="tab" id="headingOne">
      <a data-toggle="collapse" data-parent="#accordion" href="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
        <h4 class="panel-title">
          About
        </h4>
      </a>
    </div>
    <div id="collapseOne" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="headingOne">
      <div class="panel-body">
        <table class="table table-striped">
            <tr>
                <th>Location</th>
                <th>Date</th>
                <th>Actions</th>
                <th></th>
            </tr>
            <tr>
                <td> <%= @contest.location %></td>
                <td> <%= @contest.date.strftime("%B %e, %Y %l:%M %p") %></td>
                <th> <%= link_to 'Edit', edit_contest_path(@contest)%>
                <% if @contest.date < Date.today #only past contests can be deleted %>
                <%= link_to 'Delete', @contest, :method => :delete, data: {confirm: "Are you sure?"} %>
                <% else %>
                Delete
                <% end %>
                </th>
            </tr>     
            </table>
      </div>
    </div>
  </div>
  <div class="panel panel-default">
    <div class="panel-heading" role="tab" id="headingTwo">
      <a class="collapsed" data-toggle="collapse" data-parent="#accordion" href="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
        <h4 class="panel-title">
         Project Categories
        </h4>
      </a>
    </div>
    <div id="collapseTwo" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingTwo">
      <div class="panel-body">
        <h3>Project Categories</h3>
        
        <% @contest.categories.each do |category| %>
          <div id="accordion2" role="tablist" aria-multiselectable="true">
            <div class="panel panel-default">
              <div class="panel-heading" role="tab" id="headingOne<%= category.id %>">
                <a data-toggle="collapse" data-parent="#accordion2" href="#collapseOne<%= category.id %>" aria-expanded="false" aria-controls="collapseOne<%= category.id %>">
                  <%= category.name %>
                </a>
              </div>
              <div id="collapseOne<%= category.id %>" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingOne<%= category.id %>">
                <div class="panel-body">
                  <table class="table table-striped">
                    <% if @categories_projects[category.id].size == 0 %>
                      <tr><td>No projects in this category</td></tr>
                    <% end %>
                    <% @categories_projects[category.id].each do |project| %>
                      <tr><td><%= project.name %></td></tr>
                    <% end %>
                  </table>
                  <%= link_to 'Assign/Unassign Projects', contest_category_path(@contest, category)%><br>
                  <%= link_to 'Edit Name', edit_contest_category_path(@contest, category)%><br>
                  <%= link_to 'Delete Category', [@contest, category], :method => :delete, data: {confirm: "Are you sure?"} %>
                </div>
              </div>
            </div>
          </div>
        <% end %>
        <br>
        <%= link_to 'New Category', new_contest_category_path(@contest,@category) %>
      </div>
    </div>
  </div>
  <div class="panel panel-default">
    <div class="panel-heading" role="tab" id="headingThree">
      <a class="collapsed" data-toggle="collapse" data-parent="#accordion" href="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
        <h4 class="panel-title">
          Projects
        </h4>
      </a>
    </div>
    <div id="collapseThree" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingThree">
      <div class="panel-body">
        <h3>Projects</h3>
        <table class="table table-striped">
          <tr>
              <th>Name</th>
              <th>Category</th>
              <th>Location</th>
              <th>Actions</th>
          </tr>
          <% @contest.projects.each do |project| %>
          <tr>
            <th>
              <%= project.name %>
            </th>
            <th>
              <%= project.category ? project.category.name :  "No category"%>
            </th>
            <th>
              <%= project.location %>
            </th>
            <th>
              <%= link_to 'Edit', edit_contest_project_path(@contest, project)%>
              <%= link_to 'Delete', [@contest, project], :method => :delete, data: {confirm: "Are you sure?"} %>
            </th>
          <% end %>   
        </table>
        <%= link_to 'View Unassigned Projects', unassigned_projects_path(@contest) %><br/>
        <%= link_to 'Add Project', new_contest_project_path(@contest) %><br/>
      </div>
    </div>
  </div>
  <div class="panel panel-default">
    <div class="panel-heading" role="tab" id="headingFour">
      <a class="collapsed" data-toggle="collapse" data-parent="#accordion" href="#collapseFour" aria-expanded="false" aria-controls="collapseFour">
        <h4 class="panel-title">
          Question Types
        </h4>
      </a>
    </div>
    <div id="collapseFour" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingFour">
      <div class="panel-body">
        <h3>Question Types</h3>
        <table class="table table-striped">
           <tr>
                <th>Name</th>
                <th>Actions</th>
            </tr>
            <% @contest.question_types.each do |type| %>
            <tr>
                <th>
                    <%= type.question_type %>&nbsp;
                </th>
                <th>
                    <%= link_to 'Show', contest_question_type_path(@contest, type) %>
                    <%= link_to 'Edit', edit_contest_question_type_path(@contest, type)%>
                    <%= link_to 'Destroy', contest_question_type_path(@contest, type), :confirm => 'Are you sure?', :method => :delete %>
                </th>
            </tr>
            <% end %>   
        </table>
        <%= link_to 'Add Question Types', new_contest_question_type_path(@contest) %><br/>
      </div>
    </div>
  </div>
</div>
<ol class="breadcrumb">
  <li role="presentation"><%= link_to 'Upload Projects File', new_contest_attachment_path(@contest) %></li>
  <li role="presentation"><%= link_to 'Add Judges to projects', controller: "users" %></li>
  <li role="presentation"><%= link_to 'Download Scores', controller: "scores" %></li>
  <li role="presentation"><%= link_to 'Judge Project Mapping', action:'show' , controller:'judges' %></li>
</ul>